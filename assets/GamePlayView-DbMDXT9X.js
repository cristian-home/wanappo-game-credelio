import{d as v,u as w,a as S,c as d,b as a,t as i,e as t,n as T,o as u,f as b,r as y,g as I,w as B,h as R,i as x,_ as E,F as M,j as W,k as K,L as U,l as X,m as Z,p as J,q as Q,s as h}from"./index-BqhB9dUn.js";const Y={class:"flex gap-6"},ee={class:"outline-yellow flex flex-row items-center justify-center gap-2 rounded-2xl bg-white px-4 py-1 outline-8 outline-solid"},te={class:"text-black"},se={class:"text-primary-green font-bold"},ae={class:"outline-yellow flex flex-row items-center justify-center gap-2 rounded-2xl bg-white px-4 py-1 outline-8 outline-solid"},oe={class:"text-black"},le={class:"text-primary-green font-bold"},ne={class:"outline-orange flex flex-row items-center justify-center gap-2 rounded-2xl bg-white px-4 py-1 outline-8 outline-solid"},ie={class:"text-black"},re={class:"outline-magenta flex flex-row items-center justify-center gap-2 rounded-2xl bg-white px-4 py-1 outline-8 outline-solid"},ce={class:"text-black"},ue={class:"text-magenta font-bold"},de=v({__name:"GameStats",setup(f){const s=w(),{t:e}=S();return(n,o)=>(u(),d("div",Y,[a("div",ee,[a("div",te,i(t(e)("stats.level")),1),a("div",se,i(t(s).currentLevel),1)]),a("div",ae,[a("div",oe,i(t(e)("stats.score")),1),a("div",le,i(t(s).score),1)]),a("div",ne,[a("div",ie,i(t(e)("stats.time")),1),a("div",{class:T(["font-bold",t(s).timeLeft<=10?"animate-pulse text-red-500":"text-orange"])},i(t(s).timeLeft)+"s ",3)]),a("div",re,[a("div",ce,i(t(e)("stats.bugsLeft")),1),a("div",ue,i(t(s).bugsRemaining),1)])]))}}),ge={class:"flex gap-2"},me=["disabled"],pe=v({__name:"GameControls",emits:["togglePause","goHome"],setup(f,{emit:s}){const e=w(),{t:n}=S(),o=s,c=()=>{o("togglePause")},m=()=>{o("goHome")};return(p,r)=>(u(),d("div",ge,[a("button",{onClick:c,disabled:!t(e).isPlaying,class:T(["btn-primary rounded-l-full rounded-r-none bg-yellow-700 px-4 py-2 text-sm font-semibold outline-6 hover:scale-100",{"active border-yellow-900 bg-yellow-500 text-white":t(e).isPaused,"hover:border-yellow-400 hover:bg-yellow-500":!t(e).isPaused&&t(e).isPlaying}])},i(t(e).isPaused?t(n)("game.resume"):t(n)("game.pause")),11,me),a("button",{onClick:m,class:"btn-primary rounded-l-none rounded-r-full bg-red-500 px-4 py-2 text-sm font-semibold outline-6 hover:scale-100 hover:border-red-400 hover:bg-red-100 hover:text-red-700"},i(t(n)("game.quit")),1)]))}}),fe={class:"overflow-visible"},_e={class:"flex h-auto w-full flex-col items-center justify-between gap-6 md:flex-row"},ve=v({__name:"GameHeader",emits:["togglePause","goHome"],setup(f,{emit:s}){const e=s,n=()=>{e("togglePause")},o=()=>{e("goHome")};return(c,m)=>(u(),d("div",fe,[a("div",_e,[b(de),b(pe,{onTogglePause:n,onGoHome:o})])]))}}),ye="/wanappo-game-credelio/assets/tick-D8a23dTO.webp",be="/wanappo-game-credelio/assets/dead_tick-DKKwq6L2.webp",he=v({__name:"TickBug",props:{bug:{}},emits:["bugClick","splatted"],setup(f,{emit:s}){const e=f,n=s,o=y(!1),c=y(!1),m=()=>{e.bug.isAlive&&n("bugClick",e.bug.id)},p=I(()=>Math.atan2(e.bug.velocityY,e.bug.velocityX)*180/Math.PI);return B(()=>e.bug.isAlive,(r,g)=>{g&&!r&&(o.value=!0,c.value=!0,setTimeout(()=>{n("splatted",e.bug.id),c.value=!1,o.value=!1},5e3))}),(r,g)=>r.bug.isAlive?(u(),d("div",{key:0,onClick:m,class:"tick-bug flex h-32 w-32 cursor-none items-center justify-center rounded-full text-2xl transition-transform",style:x({left:r.bug.x+"px",top:r.bug.y+"px",transform:`rotate(${p.value+90}deg)`})},[a("div",{class:"h-24 w-24 bg-cover bg-center bg-no-repeat",style:x({"background-image":`url(${t(ye)})`})},null,4)],4)):c.value?(u(),d("div",{key:1,class:T(["tick-bug-splatter flex h-32 w-32 items-center justify-center text-3xl",{"animate-fade-out":o.value}]),style:x({transform:`rotate(${p.value+90}deg)`,left:r.bug.x+"px",top:r.bug.y+"px"})},[a("div",{class:"h-24 w-24 bg-cover bg-center bg-no-repeat",style:x({"background-image":`url(${t(be)})`})},null,4)],6)):R("",!0)}}),xe=E(he,[["__scopeId","data-v-db3e8d7f"]]),we={key:0,class:""},ke={class:"absolute inset-0 z-20 flex flex-col items-center justify-center bg-black/25 backdrop-blur-lg"},Pe={class:"text-4xl font-bold text-white"},$e={key:1,class:"absolute inset-0 z-20 flex flex-col items-center justify-center bg-black/25 backdrop-blur-lg"},Be={class:"animate-pulse text-xl text-white"},Ge={key:2,class:""},Re={class:"absolute inset-0 z-20 flex flex-col items-center justify-center bg-black/25 backdrop-blur-lg"},Se={class:"mb-4 text-4xl font-bold text-white"},Ce={class:"text-lg text-white"},Le=v({__name:"GameOverlay",setup(f){const s=w(),{t:e}=S();return(n,o)=>(u(),d(M,null,[t(s).isPaused?(u(),d("div",we,[a("div",ke,[o[0]||(o[0]=a("div",{class:"text-primary-green mb-4 text-6xl font-bold"},"⏸️",-1)),a("div",Pe,i(t(e)("game.paused")),1)])])):R("",!0),t(s).bugs.length===0&&t(s).isPlaying?(u(),d("div",$e,[a("div",Be,i(t(e)("game.loadingBugs")),1)])):R("",!0),!t(s).isPlaying&&!t(s).isPaused?(u(),d("div",Ge,[a("div",Re,[o[1]||(o[1]=a("div",{class:"mb-4 text-6xl font-bold"},"🎯",-1)),a("div",Se,i(t(e)("game.getReady")),1),a("div",Ce,i(t(e)("instructions.levelStarting",{level:t(s).currentLevel})),1)])])):R("",!0)],64))}}),j="/wanappo-game-credelio/assets/fur1-BzNjlrJ_.webp",A="/wanappo-game-credelio/assets/fur2-nQcXyT8W.webp",He="/wanappo-game-credelio/assets/fur4-C6hZqqZw.webp",Te=v({__name:"GameBoard",emits:["bugClick","boardReady","bugSplatted"],setup(f,{expose:s,emit:e}){const n=w(),o=y(),c=e,m=g=>{n.isPlaying&&!n.isPaused&&c("bugClick",g)},p=g=>{c("bugSplatted",g)},r=I(()=>{switch(n.currentLevel){case 1:return j;case 2:return A;case 3:return A;case 4:return He;default:return j}});return W(()=>{if(o.value){const g=o.value.clientWidth||800,k=o.value.clientHeight||600;c("boardReady",g,k)}}),s({getBoardDimensions:()=>o.value?{width:o.value.clientWidth||800,height:o.value.clientHeight||600}:{width:800,height:600}}),(g,k)=>(u(),d("div",{class:"outline-yellow relative cursor-none overflow-hidden rounded-2xl bg-cover bg-center bg-no-repeat outline-8 outline-solid",style:x({"background-image":`url(${r.value})`}),ref_key:"gameBoardRef",ref:o},[b(Le),(u(!0),d(M,null,K(t(n).bugs,P=>(u(),X(xe,{key:P.id,bug:P,onBugClick:m,onSplatted:p},null,8,["bug"]))),128)),b(t(U),{class:"absolute right-4 bottom-4 z-0 w-24"})],4))}}),je={class:"flex flex-row items-center justify-center gap-4"},Ae={class:"text-sm font-medium text-white"},Ie={class:"outline-yellow outiline-solid h-3 grow overflow-hidden rounded-full outline-4"},Me=v({__name:"GameProgress",setup(f){const s=w(),{t:e}=S();return(n,o)=>(u(),d("div",je,[a("div",Ae,i(t(e)("stats.level"))+" "+i(t(s).currentLevel)+" / "+i(t(s).maxLevel),1),a("div",Ie,[a("div",{class:"progress-fill overflow-hidden",style:x({width:t(s).currentLevel/t(s).maxLevel*100+"%"})},null,4)])]))}}),We={class:"grid h-dvh w-screen grid-cols-3 gap-4 p-8",style:{"grid-template-rows":"auto repeat(4, 1fr)"}},qe={class:"col-span-3 flex flex-col items-center justify-between gap-6"},Fe=v({__name:"GamePlayView",setup(f){const s=Z(),e=w(),n=y(),o=y(),c=y(),m=y();let p=null,r=null,g=0,k=800,P=600;const C=()=>{p=setInterval(()=>{e.updateTimer()},1e3)},$=()=>{p&&(clearInterval(p),p=null)},L=()=>{const l=_=>{_-g>=30&&(e.updateBugPositions(k,P),g=_),e.isPlaying&&!e.isPaused&&(r=requestAnimationFrame(l))};r=requestAnimationFrame(l)},H=()=>{r&&(cancelAnimationFrame(r),r=null)},q=l=>{e.spikeBug(l)},z=l=>{e.removeBug(l)},F=(l,_)=>{k=l,P=_},D=()=>{e.pauseGame()},O=()=>{e.resetGame(),s.push("/")},V=()=>{h(o.value,{initial:{opacity:0,y:-50},enter:{opacity:1,y:0,transition:{duration:600,delay:100}}}),h(c.value,{initial:{opacity:0,y:-30},enter:{opacity:1,y:0,transition:{duration:500,delay:300}}}),h(m.value,{initial:{opacity:0,scale:.9,y:0},enter:{opacity:1,scale:1,y:0,transition:{type:"spring",duration:800,delay:500}}})},N=async()=>{const l=h(o.value,{initial:{opacity:1,y:0},leave:{opacity:0,y:-50,transition:{duration:400}}}),_=h(c.value,{initial:{opacity:1,y:0},leave:{opacity:0,y:-30,transition:{duration:400,delay:100}}}),G=h(m.value,{initial:{opacity:1,scale:1,y:0},leave:{opacity:0,scale:.9,y:0,transition:{duration:600,delay:200}}});await Promise.all([l.apply("leave"),_.apply("leave"),G.apply("leave")])};return B(()=>e.isGameOver,l=>{l&&($(),s.push("/game-over"))}),B(()=>e.isGameWon,l=>{l&&($(),s.push("/game-won"))}),B(()=>e.isPlaying,l=>{l&&!e.isPaused?(C(),L()):($(),H())}),B(()=>e.isPaused,l=>{l?($(),H()):e.isPlaying&&(C(),L())}),W(()=>{if(!e.isPlaying&&!e.isPaused&&!e.isGameOver&&!e.isGameWon&&e.currentLevel===1&&e.score===0){s.replace("/");return}if(e.isGameOver){s.replace("/game-over");return}if(e.isGameWon){s.replace("/game-won");return}e.isPlaying&&!e.isPaused&&(C(),L()),V()}),J(async(l,_,G)=>{e.isPlaying||e.isPaused?G(!1):(console.log("Leaving GamePlayView, preparing animations..."),await N(),console.log("Animations completed, navigating to:",l.fullPath),G())}),Q(()=>{$(),H()}),(l,_)=>(u(),d("div",We,[a("div",qe,[b(ve,{class:"w-full",ref_key:"gameHeaderRef",ref:o,onTogglePause:D,onGoHome:O},null,512),b(Me,{class:"w-full",ref_key:"gameProgressRef",ref:c},null,512)]),a("div",{class:"col-span-3 row-span-4 row-start-2 w-full",ref_key:"gameBoardWrapperRef",ref:m},[b(Te,{class:"relative h-full w-full",ref_key:"gameBoardRef",ref:n,onBugClick:q,onBugSplatted:z,onBoardReady:F},null,512)],512)]))}});export{Fe as default};
